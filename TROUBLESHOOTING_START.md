# 启动问题排查指南

## 问题：点击"Start Assessment"按钮没有效果

### 排查步骤

#### 1. 检查服务是否启动

**前端服务（端口5173）：**
- 打开浏览器访问 http://localhost:5173
- 如果无法访问，说明前端服务未启动

**后端服务（端口3000）：**
- 打开浏览器访问 http://localhost:3000/health
- 应该看到 `{"status":"ok","version":"1.5.0"}`
- 如果无法访问，说明后端服务未启动

#### 2. 检查浏览器控制台

1. 打开浏览器开发者工具（F12）
2. 切换到"Console"标签
3. 点击"Start Assessment"按钮
4. 查看是否有错误信息

**常见错误：**

- `Failed to fetch` 或 `Network error`
  - **原因**：后端服务未启动或无法连接
  - **解决**：确保后端服务在运行（端口3000）

- `Failed to start test (400)`
  - **原因**：用户信息验证失败
  - **解决**：检查表单是否完整填写（年龄、身份、难度）

- `Failed to start test (500)`
  - **原因**：后端生成题目失败
  - **解决**：检查后端日志，可能是API Key配置问题

#### 3. 检查网络请求

1. 打开浏览器开发者工具（F12）
2. 切换到"Network"标签
3. 点击"Start Assessment"按钮
4. 查找对 `/api/start` 的请求

**检查点：**
- 请求状态码（应该是200）
- 请求URL是否正确
- 请求体是否包含用户信息
- 响应内容是什么

#### 4. 检查后端日志

查看运行后端的终端窗口，应该看到：
```
🚀 AI素养诊断器后端服务已启动
📍 端口: 3000
🌐 健康检查: http://localhost:3000/health
```

点击按钮后，应该看到：
```
收到启动请求，用户信息: { age: 25, role: 'professional', level: 'basic' }
开始生成第一题...
```

#### 5. 常见问题及解决方案

**问题1：按钮点击无反应**
- 检查浏览器控制台是否有JavaScript错误
- 检查表单验证是否通过
- 检查是否有网络请求发出

**问题2：显示"Failed to start test"**
- 检查后端服务是否运行
- 检查API Key是否配置正确
- 查看后端日志中的详细错误信息

**问题3：一直显示"Starting..."**
- 可能是网络请求卡住
- 检查后端是否正常响应
- 尝试刷新页面重试

### 调试信息

现在代码中已添加详细的调试日志：

**前端：**
- 控制台会显示：`提交用户信息: {...}`
- 控制台会显示：`开始调用 startTest API...`
- 控制台会显示：`API调用成功:` 或 `API调用失败:`

**后端：**
- 控制台会显示：`收到启动请求，用户信息: {...}`
- 控制台会显示：`验证后的用户信息: {...}`
- 控制台会显示：`开始生成第一题...`

### 快速测试

1. **测试后端连接：**
   ```bash
   curl http://localhost:3000/health
   ```
   应该返回：`{"status":"ok","version":"1.5.0"}`

2. **测试API端点：**
   ```bash
   curl -X POST http://localhost:3000/api/start \
     -H "Content-Type: application/json" \
     -d '{"age":25,"role":"professional","level":"basic"}'
   ```

### 如果问题仍然存在

1. 查看完整的浏览器控制台输出
2. 查看完整的后端日志输出
3. 检查是否有防火墙或代理阻止连接
4. 尝试重启服务



